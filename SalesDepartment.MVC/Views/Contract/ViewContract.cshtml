@using SalesDepartment.Application.UseCases.Contracts.Response;

@{
    Layout = "_Layout";
}

@model ContractResponse

<a asp-controller="Home" asp-action="index" class="btn btn-secondary back"><i class="las la-arrow-left"></i> Back to home</a>
<h3 class="text-center">Contract Info</h3>
<hr />

<div class="container" style="height: 55vh;">
    <div class="row" style="display: flex; justify-content: center;">
        <div class="col-lg-6" style="width: 100%;">
            <div class="custom-cards">
                <div class="table-container" style="overflow-y: scroll; height: 58vh; width: 100%;">
                    <table id="Contract Info" class="table">
                        <thead>
                            <tr>
                                <th style="width: 25%;">Contract Number</th>
                                <th style="width: 25%;">Contract Date</th>
                                <th style="width: 25%;">Total Amount Of Contract</th>
                                <th style="width: 25%;">Advance Payment</th>
                                <th style="width: 25%;">Monthly Payment</th>
                                <th style="width: 25%;">Number Of Months</th>
                                <th style="width: 25%;">Payment Start Date</th>
                                <th style="width: 25%;">Founder Name</th>
                            </tr>
                        </thead>
                        <tbody>
                                <tr>
                                    <td>@Model.ContractNumber</td>
                                    <td>@Model.ContractStartDate</td>
                                    <td>@Model.TotalAmountOfContract</td>
                                    <td>@Model.InAdvancePaymentOfContract</td>
                                    <td>@Model.AmountOfMonthlyPayment</td>
                                    <td>@Model.NumberOfMonths</td>
                                    <td>@Model.PaymentStartDate</td>
                                    <td>@Model.Founder.FirstName @Model.Founder.LastName</td>
                                </tr>
                        </tbody>
                    </table>
                    <table id="Apartment Info" class="table">
                        <thead>
                            <tr>
                                <th style="width: 25%;">Block</th>
                                <th style="width: 25%;">Entrance</th>
                                <th style="width: 25%;">Floor</th>
                                <th style="width: 25%;">ApartmentNumber</th>
                                <th style="width: 25%;">NumberOfRooms</th>
                                <th style="width: 25%;">Area</th>
                            </tr>
                        </thead>
                        <tbody>
                                <tr>
                                    <td>@Model.Home.Block</td>
                                    <td>@Model.Home.Entrance</td>
                                    <td>@Model.Home.Floor</td>
                                    <td>@Model.Home.ApartmentNumber</td>
                                    <td>@Model.Home.NumberOfRooms</td>
                                    <td>@Model.Home.Area</td>
                                </tr>
                        </tbody>
                    </table>
                    <table id="Customer Info" class="table">
                        <thead>
                            <tr>
                                <th style="width: 25%;">FirstName</th>
                                <th style="width: 25%;">LastName</th>
                                <th style="width: 25%;">MiddleName</th>
                                <th style="width: 25%;">Passport</th>
                                <th style="width: 25%;">PassportIssuedBy</th>
                                <th style="width: 25%;">Address</th>
                                <th style="width: 25%;">PhoneNumberOne</th>
                                <th style="width: 25%;">PhoneNumberTwo</th>
                            </tr>
                        </thead>
                        <tbody>
                           <tr>
                                <td>@Model.Customer.FirstName</td>
                                <td>@Model.Customer.LastName</td>
                                <td>@Model.Customer.MiddleName</td>
                                <td>@Model.Customer.Passport</td>
                                <td>@Model.Customer.PassportIssuedBy</td>
                                <td>@Model.Customer.Address</td>
                                <td>@Model.Customer.PhoneNumberOne</td>
                                <td>@Model.Customer.PhoneNumberTwo</td>
                           </tr>
                        </tbody>
                    </table>
                    <table id="Payment History" class="table">
                        <thead>
                            <tr>
                                <th style="width: 25%;">PaymentNumber</th>
                                <th style="width: 25%;">PaymentDate</th>
                                <th style="width: 25%;">Amount</th>
                                <th style="width: 25%;">AmountsInWords</th>
                                <th style="width: 25%;">PaymentType</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var payment in Model.Payments)
                            {
                                <tr>
                                    <td>@payment.PaymentNumber</td>
                                    <td>@payment.PaymentDate</td>
                                    <td>@payment.Amount</td>
                                    <td>@payment.PaymentType.Name</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                    <table>
                        <thead>
                            <tr>
                                <th>Number</th>
                                <th>Scheduled Dates</th>
                                <th>Scheduled Payment</th>
                                <th>Monthly Payment</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model.ScheduledInfo != null)
                            {
                                int rowNumber = 1;
                                foreach (var scheduled in Model.ScheduledInfo)
                                {
                                    <tr>
                                        <td>@rowNumber</td>
                                        <td>@scheduled.Key.ToString("yyyy-MM-dd")</td> <!-- Display scheduled date as a formatted string -->
                                        <td>@scheduled.Value.ToString("C")</td> <!-- Display scheduled payment -->
                                        <td>@Model.AmountOfMonthlyPayment.ToString("C")</td>
                                        @if (Model.ActualInfo != null && Model.ActualInfo.ContainsKey(scheduled.Key))
                                        {
                                            var actualPayment = Model.ActualInfo[scheduled.Key];
                                            <td>@scheduled.Key.ToString("yyyy-MM-dd")</td> <!-- Display payed date as a formatted string -->
                                            <td>@actualPayment.ToString("C")</td> <!-- Display payment amount -->
                                        }
                                        else
                                        {
                                            <td></td>
                                            <td></td>
                                        }
                                    </tr>
                                    rowNumber++;
                                }
                            }
                        </tbody>
                    </table>


                </div>
            </div>
        </div>
    </div>
</div>
